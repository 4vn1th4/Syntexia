<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Provider Dashboard ‚Äî FoodLink</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- LEAFLET -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Inter, sans-serif;
}

body {
  background: radial-gradient(circle at top right, #0f2a44, #050b14);
  color: #e5e7eb;
  min-height: 100vh;
  padding-top: 120px;
  display: flex;
  justify-content: center;
}

.provider-card {
  background: rgba(255,255,255,0.06);
  backdrop-filter: blur(14px);
  border-radius: 24px;
  padding: 40px;
  width: 90%;
  max-width: 520px;
  box-shadow: 0 0 50px rgba(34,197,94,0.2);
}

.provider-card h1 {
  font-size: 30px;
  margin-bottom: 10px;
}

.provider-card p {
  opacity: 0.85;
  margin-bottom: 25px;
}

.provider-card input,
.provider-card select {
  width: 100%;
  padding: 12px 14px;
  margin-bottom: 18px;
  border-radius: 12px;
  border: none;
  background: rgba(255,255,255,0.08);
  color: #e5e7eb;
}

.provider-card input::placeholder {
  color: #cbd5e1;
}

.submit-btn {
  width: 100%;
  padding: 14px;
  border-radius: 14px;
  border: none;
  background: linear-gradient(135deg, #22c55e, #16a34a);
  color: #04110a;
  font-weight: 600;
  cursor: pointer;
}

#map {
  height: 260px;
  border-radius: 16px;
  margin-bottom: 18px;
}

#aiResult {
  margin-top: 15px;
  font-weight: bold;
  color: #22c55e;
}
</style>
</head>

<body>

<div class="provider-card">
  <h1>Provider Dashboard</h1>
  <p>List your food for AI verification</p>

  <form id="providerForm">

    <input type="file" required>

    <select id="foodType" required>
      <option value="">Select Food Type</option>
      <option>Vegetables</option>
      <option>Fruits</option>
      <option>Grains</option>
      <option>Dairy</option>
      <option>Prepared Meals</option>
    </select>

    <input type="number" id="quantity" placeholder="Quantity (kg)" required>

    Production Date
    <input type="date" id="productionDate" required>

    Expiry Date
    <input type="date" id="expiryDate" required>

    <input type="text" id="pickupWindow" placeholder="Pickup Window (e.g. 2‚Äì4 PM)" required>

    <p style="margin-bottom:8px;">üìç Click on map to select pickup location</p>
    <div id="map"></div>

    <input type="hidden" id="lat">
    <input type="hidden" id="lng">

    <button type="submit" class="submit-btn">
      Submit for AI Verification
    </button>
  </form>

  <p id="aiResult"></p>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {

  const lat = document.getElementById("lat");
  const lng = document.getElementById("lng");
  const form = document.getElementById("providerForm");
  const result = document.getElementById("aiResult");

  /* MAP */
  const map = L.map("map").setView([25.2048, 55.2708], 10);

  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: "¬© OpenStreetMap"
  }).addTo(map);

  let marker;

  map.on("click", function (e) {
    if (marker) map.removeLayer(marker);

    marker = L.marker(e.latlng)
      .addTo(map)
      .bindPopup("Pickup Location")
      .openPopup();

    lat.value = e.latlng.lat;
    lng.value = e.latlng.lng;
  });

  /* FORM SUBMIT */
  form.addEventListener("submit", function (e) {
    e.preventDefault();

    if (!lat.value || !lng.value) {
      alert("Please select pickup location on the map");
      return;
    }

    result.textContent = "Verifying with AI... ‚è≥";

    setTimeout(() => {
      const listing = {
        foodType: foodType.value,
        quantity: quantity.value,
        productionDate: productionDate.value,
        expiryDate: expiryDate.value,
        pickupWindow: pickupWindow.value,
        lat: lat.value,
        lng: lng.value
      };

      const listings =
        JSON.parse(localStorage.getItem("foodListings")) || [];

      listings.push(listing);
      localStorage.setItem("foodListings", JSON.stringify(listings));

      result.textContent = "AI Verified: Listing saved ‚úÖ";
      form.reset();
      if (marker) map.removeLayer(marker);
    }, 2000);
  });

});
</script>

</body>
</html>
  
