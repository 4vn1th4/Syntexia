<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FoodLink ‚Äî Receiver</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- LEAFLET -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: Inter, sans-serif; background: radial-gradient(circle at top right, #0f2a44, #050b14); color: #e5e7eb; }

/* NAVBAR */
nav {
  position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
  width: 90%; max-width: 1200px; background: rgba(255,255,255,0.08);
  backdrop-filter: blur(14px); border-radius: 18px; padding: 14px 28px;
  display: flex; justify-content: space-between; align-items: center; z-index: 1000;
}
.logo { font-size: 2em; color: #22c55e; background: transparent; border: none; }
.nav-btn { padding: 8px 16px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.25); background: transparent; color: white; cursor: pointer; }

/* MAIN */
.main-container { padding: 160px 8% 80px; max-width: 1400px; margin: auto; }

/* DASHBOARD */
.dashboard-bar { background: linear-gradient(135deg, rgba(34,197,94,0.35), rgba(59,130,246,0.25)); border-radius: 20px; padding: 26px 32px; margin-bottom: 30px; box-shadow: 0 0 80px rgba(34,197,94,0.25); }

/* LISTINGS */
.listings-grid { display: grid; grid-template-columns: 1fr; gap: 24px; max-height: 700px; overflow-y: auto; padding-right: 8px; }
.listing-card { background: rgba(255,255,255,0.06); border-radius: 22px; padding: 24px; display: flex; gap: 20px; align-items: center; }
.listing-card img { width: 120px; height: 120px; object-fit: cover; border-radius: 16px; }
.listing-info { flex: 1; }
.listing-info h3 { margin-bottom: 6px; }
.listing-info p { margin-bottom: 4px; font-size: 14px; color: #cbd5e1; }
.locate-btn { padding: 10px 14px; border-radius: 12px; border: none; background: rgba(34,197,94,0.15); color: #22c55e; font-weight: 600; cursor: pointer; }
.locate-btn:hover { background: #22c55e; color: #04110a; }

/* MAP */
#map-section { padding: 40px 0 80px 0; display: none; flex-direction: column; gap: 12px; }
#map { height: 420px; border-radius: 18px; box-shadow: 0 0 40px rgba(34,197,94,0.25); }
#routeInfo { font-weight: bold; }

/* SCROLLBAR */
.listings-grid::-webkit-scrollbar { width: 8px; }
.listings-grid::-webkit-scrollbar-thumb { background: rgba(34,197,94,0.5); border-radius: 4px; }

</style>
</head>

<body>
<!-- NAVBAR -->
<nav>
  <button class="logo">FOODLINK</button>
  <div>
    <button class="nav-btn" onclick="location.href='index.html'">Home</button>
    <button class="nav-btn" onclick="location.href='provider.html'">Provider</button>
    <button class="nav-btn" onclick="location.href='receiver.html'">Receiver</button>
  </div>
</nav>

<!-- MAIN -->
<div class="main-container">
  <div class="dashboard-bar">
    <h1>Receiver Dashboard</h1>
    <p>Browse available food providers near you</p>
  </div>

  <!-- DYNAMIC LISTINGS -->
  <div class="listings-grid" id="listings"></div>

  <!-- MAP SECTION -->
  <div id="map-section">
    <h2>üìç Provider Location</h2>
    <div id="map"></div>
    <p id="routeInfo"></p>
  </div>
</div>

<script>
/* MAP INIT */
let map, providerMarker, userMarker, routeLine;

/* SAMPLE LISTINGS */
const listings = [
  { name: "Fresh Vegetables", quantity: "30 kg", lat: 0.3476, lng: 32.5825, img: "https://images.pexels.com/photos/70497/pexels-photo-70497.jpeg?auto=compress&cs=tinysrgb&w=800" },
  { name: "Cooked Meals", quantity: "20 meals", lat: -1.2921, lng: 36.8219, img: "https://images.pexels.com/photos/262959/pexels-photo-262959.jpeg?auto=compress&cs=tinysrgb&w=800" },
  { name: "Rice Bags", quantity: "50 kg", lat: 6.5244, lng: 3.3792, img: "https://images.pexels.com/photos/2097090/pexels-photo-2097090.jpeg?auto=compress&cs=tinysrgb&w=800" },
  { name: "Bread Packs", quantity: "40 packs", lat: 9.0820, lng: 8.6753, img: "https://images.pexels.com/photos/1640777/pexels-photo-1640777.jpeg?auto=compress&cs=tinysrgb&w=800" },
  { name: "Fruits", quantity: "25 kg", lat: -26.2041, lng: 28.0473, img: "https://images.pexels.com/photos/1437267/pexels-photo-1437267.jpeg?auto=compress&cs=tinysrgb&w=800" },
  { name: "Milk Bottles", quantity: "60 bottles", lat: 1.2921, lng: 36.8219, img: "https://images.pexels.com/photos/691167/pexels-photo-691167.jpeg?auto=compress&cs=tinysrgb&w=800" },
  { name: "Egg Cartons", quantity: "100 cartons", lat: -33.9249, lng: 18.4241, img: "https://images.pexels.com/photos/461198/pexels-photo-461198.jpeg?auto=compress&cs=tinysrgb&w=800" },
  { name: "Packaged Veggies", quantity: "35 packs", lat: 7.8731, lng: 80.7718, img: "https://images.pexels.com/photos/1656667/pexels-photo-1656667.jpeg?auto=compress&cs=tinysrgb&w=800" }
];

/* LOAD LISTINGS */
const container = document.getElementById("listings");
listings.forEach((item,index) => {
  container.innerHTML += `
    <div class="listing-card">
      <img src="${item.img}" alt="${item.name}">
      <div class="listing-info">
        <h3>${item.name}</h3>
        <p>Quantity: ${item.quantity}</p>
        <p>Location: Africa</p>
        <button class="locate-btn" onclick="locateProvider(${item.lat}, ${item.lng})">Locate Now</button>
      </div>
    </div>
  `;
});

/* LOCATE PROVIDER FUNCTION */
function locateProvider(lat, lng){
  if(!map){
    map = L.map('map').setView([lat, lng], 6);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '¬© OpenStreetMap' }).addTo(map);
  } else {
    map.setView([lat,lng],6);
    if(providerMarker) map.removeLayer(providerMarker);
    if(userMarker) map.removeLayer(userMarker);
    if(routeLine) map.removeLayer(routeLine);
  }

  document.getElementById('map-section').style.display='flex';

  providerMarker = L.marker([lat,lng]).addTo(map).bindPopup("Provider Location").openPopup();

  map.on('click', function(e){
    if(userMarker) map.removeLayer(userMarker);
    if(routeLine) map.removeLayer(routeLine);
    userMarker = L.marker(e.latlng).addTo(map).bindPopup("Your Location").openPopup();
    routeLine = L.polyline([providerMarker.getLatLng(), e.latlng], { dashArray: '6,6' }).addTo(map);

    const distance = providerMarker.getLatLng().distanceTo(e.latlng)/1000;
    const time = (distance/40)*60;
    document.getElementById('routeInfo').innerHTML = `üöó Distance: ${distance.toFixed(2)} km | ‚è± Estimated Time: ${time.toFixed(0)} mins`;
  });
}

</script>
</body>
</html>
